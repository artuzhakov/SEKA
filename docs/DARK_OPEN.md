# SEKA — Режимы DARK и OPEN (DARK_OPEN.md)

Этот документ описывает логику режимов:

- `DARK` — игра в тёмную
- `OPEN` — открытый режим (игрок видит свои карты)

---

## 1. Общие положения

Игрок может находиться в одном из режимов:

- `MODE_NONE` — режим по умолчанию, карты не смотрел;
- `MODE_DARK` — играет в темную;
- `MODE_OPEN` — смотрит свои карты.

Переходы:

```text
MODE_NONE → MODE_DARK → MODE_OPEN
MODE_NONE → MODE_OPEN
MODE_OPEN → (назад нельзя)
```

---

## 2. DARK

### 2.1 Кто может выбрать DARK

Только игрок сразу после дилера, и только:

- в 1-м раунде;
- либо во 2-м раунде, если он до этого не выбирал режим и ещё в `MODE_NONE`.

Другие игроки **никогда** не могут выбрать DARK.

### 2.2 Условия выбора DARK

- игрок в статусе `IN_GAME`;
- его режим `MODE_NONE`;
- таймер хода не истёк.

### 2.3 Поведение в DARK

- игрок **не смотрит свои карты**;
- получает право ставить по «темной» схеме (половина со счёта, полная в банк) — см. `BETTING_RULES.md`;
- против него можно сыграть `REVEAL`;
- он может сам инициировать `REVEAL` (со 2-го раунда).

В 3-м раунде:

- выбрать DARK нельзя,
- но если игрок уже в DARK, он остаётся в этом режиме, **но без скидок по ставкам**.

---

## 3. OPEN

### 3.1 Условия выбора OPEN

Игрок может выбрать OPEN:

- в любом раунде;
- до совершения своего действия в этом раунде;
- если он не был в OPEN ранее;
- если таймер хода не истёк.

Если игрок был в DARK:

- он может изменить режим `MODE_DARK → MODE_OPEN`,
- только если ещё не делал ставок и не отработал таймер.

### 3.2 Последствия OPEN

- игрок видит свои карты;
- режим фиксируется (`MODE_OPEN`);
- вернуть DARK невозможно;
- OPEN не влияет на `pot`, `currentStake`, `player.bet`.

OPEN — это **лишь визуальный/режимный выбор**, а не финансовое действие.

---

## 4. Взаимодействие с REVEAL

- При REVEAL карты видят **только два участника REVEAL**.
- Против DARK-игрока REVEAL работает как обычно:
  - сравнение комбинаций;
  - проигравший становится `FOLDED`.
